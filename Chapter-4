I=imread('lena.jpg');
R=I(:)';
format long;
x=0.766;
p=0.3432;
x(1)=0.766;
for i=1:196608-1
    if(x(i)>=0&&x(i)<p)
      x(i+1)=x(i)/p;
    elseif(x(i)>=p&&x(i)<0.5)
      x(i+1)=((x(i)-p)/(0.5-p));
    elseif(x(i)>=0.5&&x(i)<1)
        if((1-x(i))>=0&&(1-x(i))<p)
        x(i+1)=(1-x(i))/p;
        elseif((1-x(i))>=p&&(1-x(i))<0.5)
        x(i+1)=((1-x(i))-p)/(0.5-p);
        end
    end
end
H=sort(x);
[H,T]=sort(x);
P=R(T);
P=P+1;
T=uint8([44 48 61 97 202 76 139 253 196 92 186 120 113 245 251 213 ...
49 64 106 226 5 219 27 2 195 95 185 123 54 78 145 237 ...
19 42 50 66 111 239 18 17 174 154 43 47 58 90 181 134 ...
94 192 104 220 25 193 99 207 60 96 197 89 177 147 231 126 ...
108 233 187 119 91 184 125 20 56 83 161 102 215 38 31 11 ...
162 188 114 249 223 16 23 248 230 141 224 12 109 234 69 121 ...
159 198 87 172 160 88 175 152 216 34 21 65 143 242 217 255 ...
24 130 157 203 72 128 67 15 3 201 77 142 246 209 144 22 ...
82 158 199 74 135 221 240 1 116 117 137 156 206 107 229 63 ...
200 205 68 133 75 138 153 214 39 35 112 243 124 37 28 232 ...
254 194 98 167 45 247 238 4 212 46 53 180 122 110 118 150 ...
136 131 140 250 84 163 129 183 7 169 170 236 59 155 208 190 ...
79 105 222 14 55 81 211 6 151 26 165 93 0 182 132 40 ...
171 73 86 168 101 32 13 228 210 51 173 100 115 252 71 191 ...
218 204 70 30 8 36 176 225 10 148 179 166 52 57 103 164 ...
127 29 9 241 189 41 33 227 244 146 235 80 178 149 62 85
])
A=T(P);
format long;
x=0.7666;
for n=2:196608
x(n)= 3.9999*x(n-1)*(1-x(n-1));
end
a=x(1,:);
m = min(a)
n = max(a)
o = n - m
d = uint8(254*((a-m)/o))+1
F=reshape(A, 256, 256, 3);
K = reshape(d, 256, 256, 3);
c = bitxor(K,F);
recu=c(:)'; 
for i=1:196608
if (i==1)
recur(i)= recu(i);
elseif (ge(i,2))
recur(i)= bitxor( (recu(i)),(recur(i-1)));
end
end
recurs = reshape(recur, 256, 256, 3);
figure,imshow(recurs)
